<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><title>xbz0n@sh:~# <!-- -->Exploiting the vulnerability and gaining root privileges (CVE-2023-0830)</title><meta name="description" content="Ivan Spiridonov (xbz0n) - Offensive security professional specializing in Red Teaming, Web/Mobile/AD Pentesting, and vulnerability research. Discover pentesting insights, exploit techniques, and security tools."/><meta property="og:type" content="article"/><meta property="og:url" content="https://xbz0n.sh/blog/cve-2023-0830"/><meta property="og:title" content="Exploiting the vulnerability and gaining root privileges (CVE-2023-0830)"/><meta property="og:description" content="Recently, I discovered a vulnerability which was in a backup and restore script used in EasyNAS, a popular open-source network-attached storage (NAS) solutio..."/><meta property="twitter:card" content="summary_large_image"/><meta property="twitter:url" content="https://xbz0n.sh/blog/cve-2023-0830"/><meta property="twitter:title" content="Exploiting the vulnerability and gaining root privileges (CVE-2023-0830)"/><meta property="twitter:description" content="Recently, I discovered a vulnerability which was in a backup and restore script used in EasyNAS, a popular open-source network-attached storage (NAS) solutio..."/><meta property="author" content="Ivan Spiridonov"/><link rel="canonical" href="https://xbz0n.sh/blog/cve-2023-0830"/><meta name="next-head-count" content="18"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/e769ab7df2272fb4.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/e769ab7df2272fb4.css" crossorigin="" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-fa99431b15635937.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/framework-fae63b21a27d6472.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/main-7f705b62e1c5c87e.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/_app-5894f79c417ecb15.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/260-e9b07f57f9f93770.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-ea87641b9adf9e7a.js" defer="" crossorigin=""></script><script src="/_next/static/WS_KhD9dT_dxgrymrSdkC/_buildManifest.js" defer="" crossorigin=""></script><script src="/_next/static/WS_KhD9dT_dxgrymrSdkC/_ssgManifest.js" defer="" crossorigin=""></script><style data-href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&display=swap">@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKxjPg.woff) format('woff')}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8-qxjPg.woff) format('woff')}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbY2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8L6tjPg.woff) format('woff')}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx3cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxTcwgknk-6nFg.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxPcwgknk-6nFg.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx_cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx7cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxDcwgknk-4.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx3cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxTcwgknk-6nFg.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxPcwgknk-6nFg.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx_cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx7cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxDcwgknk-4.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx3cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxTcwgknk-6nFg.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxPcwgknk-6nFg.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx_cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPx7cwgknk-6nFg.woff2) format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'JetBrains Mono';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/jetbrainsmono/v20/tDbv2o-flEEny0FZhsfKu5WU4zr3E_BX0PnT8RD8yKwBNntkaToggR7BYRbKPxDcwgknk-4.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><div class="flex flex-col min-h-screen"><nav class="bg-primary/80 backdrop-blur-sm sticky top-0 z-10 shadow-md"><div class="container py-4"><div class="flex items-center justify-between"><div class="flex items-center space-x-6"><a href="/"><span class="text-xl font-bold tracking-tighter bg-gradient-to-r from-accent to-blue-500 bg-clip-text text-transparent">xbz0n@sh:~#</span></a><div class="hidden md:flex space-x-6"><a class="nav-link" href="/">Home</a><a class="nav-link" href="/about">About</a><a class="nav-link" href="/blog">Blog</a><a class="nav-link" href="/tools">Tools</a><a class="nav-link" href="/cves">CVEs</a></div></div><div class="hidden md:flex items-center space-x-4"><a href="mailto:ivanspiridonov@gmail.com" class="text-gray-300 hover:text-accent" aria-label="Email"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="w-5 h-5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg></a><a href="https://github.com/xbz0n" target="_blank" rel="noopener noreferrer" class="text-gray-300 hover:text-accent" aria-label="GitHub"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" class="w-5 h-5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a><a href="https://twitter.com/xbz0n" target="_blank" rel="noopener noreferrer" class="text-gray-300 hover:text-accent" aria-label="Twitter"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="w-5 h-5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a><a href="https://www.linkedin.com/in/ivanspiridonov/" target="_blank" rel="noopener noreferrer" class="text-gray-300 hover:text-accent" aria-label="LinkedIn"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" class="w-5 h-5" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"></path></svg></a></div><button class="md:hidden focus:outline-none" aria-label="Toggle menu"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" class="h-6 w-6 text-gray-300" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"></path></svg></button></div></div></nav><main class="flex-grow container py-8"><article class="max-w-3xl mx-auto"><a class="text-accent hover:text-accent/80 mb-8 inline-block" href="/blog">← Back to all posts</a><div class="mb-8"><h1 class="text-3xl md:text-4xl font-bold mb-4">Exploiting the vulnerability and gaining root privileges (CVE-2023-0830)</h1><div class="flex items-center text-sm text-gray-400"><time dateTime="2023-02-14">February 14, 2023</time></div></div><div class="blog-content"><h2>Introduction</h2>
<p>Recently, I discovered a vulnerability which was in a backup and restore script used in EasyNAS, a popular open-source network-attached storage (NAS) solution. The CVE-2023-0830 is published on <a href="https://vuldb.com/?id.220950">https://vuldb.com/?id.220950</a>. The vulnerability, which allows for arbitrary command execution with root privileges, can be exploited by an attacker to delete important system files, modify or steal sensitive data, or even gain unauthorized access to the system.</p>
<p>In this blog post, I will show how an attacker can exploit this vulnerability by crafting a malicious GET request to the WebUI of the EasyNAS system, I will show the vulnerable script code and how to mitigate the issue.</p>
<h2>Details of the Vulnerability</h2>
<p>The vulnerability is present in the backup and restore script, which is used to create and restore backups of the EasyNAS system. The script is written in Perl and is executed through the web interface of the EasyNAS system. The vulnerability lies in the use of the <code>system</code> function to execute a command with user-supplied input. The following is the vulnerable script code:</p>
<pre class="language-perl"><code class="language-perl">$rc=system("/usr/bin/sudo /usr/bin/tar cvf $mount_dir/$vol/$file @config_files > /dev/null" );
</code></pre>
<p>As seen in the code above, the script is using the system function to execute the command:</p>
<pre class="language-bash"><code class="language-bash">/usr/bin/sudo /usr/bin/tar cvf $mount_dir/$vol/$file @config_files > /dev/null
</code></pre>
<p>This command creates a backup of certain system files and stores it in the <code>$mount_dir/$vol</code> directory. The problem is that the <code>$file</code> variable and the <code>$vol</code> variable are being passed in as user-supplied input, without proper validation or sanitization. An attacker can craft a malicious GET request to the WebUI of the EasyNAS system, injecting a malicious command into the "name" and "vol" parameters of the GET request.</p>
<p>For example, an attacker could use the following GET request:</p>
<pre class="language-none"><code class="language-none">/easynas/backup.pl?action=backup&#x26;menu=none&#x26;.submit=Backup&#x26;name=%7cwhoami%7c%7ca+%23
</code></pre>
<p>This request would execute the command "whoami" which would reveal the current user, this could lead to unauthorized access to the system or privilege escalation.</p>
<h2>Exploitation Process</h2>
<p>Let me walk through the exact exploitation process step by step:</p>
<ol>
<li>First, I identified that the EasyNAS backup script accepts user input for filename and volume parameters without proper sanitization</li>
<li>By analyzing the source code, I noticed that these parameters are directly passed to a system command</li>
<li>I crafted a specially formatted GET request with command injection payload in the <code>name</code> parameter</li>
<li>The payload contained properly URL-encoded command separators (<code>|</code>) and comment characters (<code>#</code>) to execute arbitrary commands</li>
<li>When this request was sent to the backup script, it executed my command with root privileges due to the sudo usage</li>
</ol>
<p>This exploit highlights a classic case of command injection vulnerability, where user-controlled input is directly incorporated into system commands without proper escaping or validation.</p>
<h2>Mitigation</h2>
<p>The vulnerability can be mitigated by properly validating and sanitizing user input. One way to do this is using the Perl module CGI.pm's built-in param method, which will remove any leading or trailing whitespace and control characters from the user input. Additionally, the use of regular expressions can be used to validate user input and ensure that it only contains allowed characters.</p>
<p>Another way to mitigate this vulnerability is to use the Perl module Taint.pm, which can be used to enable taint mode in the script. Taint mode ensures that all user-supplied input is "tainted", which means that it is considered unsafe to use in the system.</p>
<p>Recommendations for fixing this vulnerability:</p>
<ol>
<li>Implement strict input validation with a whitelist approach (only allow alphanumeric characters and specific symbols)</li>
<li>Use prepared statements or parameterized APIs where possible</li>
<li>Avoid using sudo in scripts, especially for web applications</li>
<li>Implement proper privilege separation, running the web interface with minimal permissions</li>
<li>Consider using the perl <code>use strict</code> and <code>use warnings</code> directives to catch potential issues</li>
<li>Apply the principle of least privilege throughout the application</li>
</ol>
<h2>Conclusion</h2>
<p>This vulnerability in the backup and restore script for EasyNAS is a serious issue that can potentially lead to unauthorized access to the system. It is important to take the necessary steps to protect your EasyNAS systems and to be aware of this vulnerability.</p>
<p>The vulnerability can be mitigated by properly validating and sanitizing user input, avoiding the use of "sudo" in scripts, and using the "su" command. This is a reminder that it is important to keep software updated and aware of vulnerabilities. Even open-source software, like EasyNAS, can have security issues. It is important to be aware of the potential risks and to take the necessary steps to protect your systems.</p>
<h2>References</h2>
<ul>
<li><a href="https://github.com/example/easynas-exploit">EasyNAS 1.1.0 — Authenticated OS Command Injection Exploit (github.com)</a></li>
<li><a href="https://www.cve.org/CVERecord?id=CVE-2023-0830">CVE-2023-0830</a></li>
<li><a href="https://vuldb.com/?id.220950">VulDB Entry 220950</a></li>
</ul>
</div></article></main><footer class="bg-primary/90 border-t border-gray-800"><div class="container py-6"><div class="flex justify-center items-center"><div class="text-sm text-gray-400">© <!-- -->2025<!-- --> Ivan Spiridonov (xbz0n). All rights reserved.</div></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"postData":{"slug":"cve-2023-0830","contentHtml":"\u003ch2\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eRecently, I discovered a vulnerability which was in a backup and restore script used in EasyNAS, a popular open-source network-attached storage (NAS) solution. The CVE-2023-0830 is published on \u003ca href=\"https://vuldb.com/?id.220950\"\u003ehttps://vuldb.com/?id.220950\u003c/a\u003e. The vulnerability, which allows for arbitrary command execution with root privileges, can be exploited by an attacker to delete important system files, modify or steal sensitive data, or even gain unauthorized access to the system.\u003c/p\u003e\n\u003cp\u003eIn this blog post, I will show how an attacker can exploit this vulnerability by crafting a malicious GET request to the WebUI of the EasyNAS system, I will show the vulnerable script code and how to mitigate the issue.\u003c/p\u003e\n\u003ch2\u003eDetails of the Vulnerability\u003c/h2\u003e\n\u003cp\u003eThe vulnerability is present in the backup and restore script, which is used to create and restore backups of the EasyNAS system. The script is written in Perl and is executed through the web interface of the EasyNAS system. The vulnerability lies in the use of the \u003ccode\u003esystem\u003c/code\u003e function to execute a command with user-supplied input. The following is the vulnerable script code:\u003c/p\u003e\n\u003cpre class=\"language-perl\"\u003e\u003ccode class=\"language-perl\"\u003e$rc=system(\"/usr/bin/sudo /usr/bin/tar cvf $mount_dir/$vol/$file @config_files \u003e /dev/null\" );\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAs seen in the code above, the script is using the system function to execute the command:\u003c/p\u003e\n\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003e/usr/bin/sudo /usr/bin/tar cvf $mount_dir/$vol/$file @config_files \u003e /dev/null\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis command creates a backup of certain system files and stores it in the \u003ccode\u003e$mount_dir/$vol\u003c/code\u003e directory. The problem is that the \u003ccode\u003e$file\u003c/code\u003e variable and the \u003ccode\u003e$vol\u003c/code\u003e variable are being passed in as user-supplied input, without proper validation or sanitization. An attacker can craft a malicious GET request to the WebUI of the EasyNAS system, injecting a malicious command into the \"name\" and \"vol\" parameters of the GET request.\u003c/p\u003e\n\u003cp\u003eFor example, an attacker could use the following GET request:\u003c/p\u003e\n\u003cpre class=\"language-none\"\u003e\u003ccode class=\"language-none\"\u003e/easynas/backup.pl?action=backup\u0026#x26;menu=none\u0026#x26;.submit=Backup\u0026#x26;name=%7cwhoami%7c%7ca+%23\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis request would execute the command \"whoami\" which would reveal the current user, this could lead to unauthorized access to the system or privilege escalation.\u003c/p\u003e\n\u003ch2\u003eExploitation Process\u003c/h2\u003e\n\u003cp\u003eLet me walk through the exact exploitation process step by step:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eFirst, I identified that the EasyNAS backup script accepts user input for filename and volume parameters without proper sanitization\u003c/li\u003e\n\u003cli\u003eBy analyzing the source code, I noticed that these parameters are directly passed to a system command\u003c/li\u003e\n\u003cli\u003eI crafted a specially formatted GET request with command injection payload in the \u003ccode\u003ename\u003c/code\u003e parameter\u003c/li\u003e\n\u003cli\u003eThe payload contained properly URL-encoded command separators (\u003ccode\u003e|\u003c/code\u003e) and comment characters (\u003ccode\u003e#\u003c/code\u003e) to execute arbitrary commands\u003c/li\u003e\n\u003cli\u003eWhen this request was sent to the backup script, it executed my command with root privileges due to the sudo usage\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThis exploit highlights a classic case of command injection vulnerability, where user-controlled input is directly incorporated into system commands without proper escaping or validation.\u003c/p\u003e\n\u003ch2\u003eMitigation\u003c/h2\u003e\n\u003cp\u003eThe vulnerability can be mitigated by properly validating and sanitizing user input. One way to do this is using the Perl module CGI.pm's built-in param method, which will remove any leading or trailing whitespace and control characters from the user input. Additionally, the use of regular expressions can be used to validate user input and ensure that it only contains allowed characters.\u003c/p\u003e\n\u003cp\u003eAnother way to mitigate this vulnerability is to use the Perl module Taint.pm, which can be used to enable taint mode in the script. Taint mode ensures that all user-supplied input is \"tainted\", which means that it is considered unsafe to use in the system.\u003c/p\u003e\n\u003cp\u003eRecommendations for fixing this vulnerability:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eImplement strict input validation with a whitelist approach (only allow alphanumeric characters and specific symbols)\u003c/li\u003e\n\u003cli\u003eUse prepared statements or parameterized APIs where possible\u003c/li\u003e\n\u003cli\u003eAvoid using sudo in scripts, especially for web applications\u003c/li\u003e\n\u003cli\u003eImplement proper privilege separation, running the web interface with minimal permissions\u003c/li\u003e\n\u003cli\u003eConsider using the perl \u003ccode\u003euse strict\u003c/code\u003e and \u003ccode\u003euse warnings\u003c/code\u003e directives to catch potential issues\u003c/li\u003e\n\u003cli\u003eApply the principle of least privilege throughout the application\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003eConclusion\u003c/h2\u003e\n\u003cp\u003eThis vulnerability in the backup and restore script for EasyNAS is a serious issue that can potentially lead to unauthorized access to the system. It is important to take the necessary steps to protect your EasyNAS systems and to be aware of this vulnerability.\u003c/p\u003e\n\u003cp\u003eThe vulnerability can be mitigated by properly validating and sanitizing user input, avoiding the use of \"sudo\" in scripts, and using the \"su\" command. This is a reminder that it is important to keep software updated and aware of vulnerabilities. Even open-source software, like EasyNAS, can have security issues. It is important to be aware of the potential risks and to take the necessary steps to protect your systems.\u003c/p\u003e\n\u003ch2\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/example/easynas-exploit\"\u003eEasyNAS 1.1.0 — Authenticated OS Command Injection Exploit (github.com)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2023-0830\"\u003eCVE-2023-0830\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://vuldb.com/?id.220950\"\u003eVulDB Entry 220950\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","excerpt":"Recently, I discovered a vulnerability which was in a backup and restore script used in EasyNAS, a popular open-source network-attached storage (NAS) solutio...","title":"Exploiting the vulnerability and gaining root privileges (CVE-2023-0830)","date":"2023-02-14","tags":["vulnerability","easynas","command injection","cve"]}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"cve-2023-0830"},"buildId":"WS_KhD9dT_dxgrymrSdkC","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>